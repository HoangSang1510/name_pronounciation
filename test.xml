<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Theo dõi điều trị -->
    <record id="view_medical_treatment_icsi_fet_form" model="ir.ui.view">
        <field name="name">view.medical.treatment.fet.form</field>
        <field name="model">medical.treatment</field>
        <field name="priority">16</field>
        <field name="arch" type="xml">
            <form string="Theo dõi điều trị FET" delete="false">
                <field name="active" invisible="1"/>
                <header>
                    <button name="action_create_result" string="Create Treatment Result" type="object" confirm="Are you sure you want to create treatment result?" class="oe_highlight"/>
                    <button name="action_lock" string="Lock" type="object" confirm="Are you sure you want to lock treatment?"
                        class="btn-secondary"
                        attrs="{'invisible': ['|', ('is_locked', '=', True), ('last_stage', '=', False)]}"/>
                    <button name="action_unlock" string="Unlock" type="object"
                        class="btn-secondary"
                        attrs="{'invisible': ['|', ('is_locked', '=', False),('last_stage', '=', False)]}"
                        groups="ims_treatment.group_manager"/>
                    <field name="state_id" widget="statusbar" readonly="1"/>
                </header>
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="button_list_culture" type="object" class="oe_stat_button" style="width: 12.5%;">
                            <div class="fa fa-fw o_button_icon">
                                <img src="/ims_treatment/static/description/icon_cultured.png" alt="Cultured"/>
                            </div>
                            <label for="culture_count" attrs="{'invisible': [('culture_count','!=',0)]}"/>
                            <field name="culture_count" widget="statinfo" attrs="{'invisible': [('culture_count','=',0)]}"/>
                        </button>
                        <button name="button_list_test" type="object" class="oe_stat_button" icon="fa-flask" style="width: 12.5%;">
                            <label for="test_count" attrs="{'invisible': [('test_count','!=',0)]}"/>
                            <field name="test_count" widget="statinfo" attrs="{'invisible': [('test_count','=',0)]}"/>
                        </button>
                        <button name="button_list_template" type="object" class="oe_stat_button" style="width: 12.5%;">
                            <div class="fa fa-fw o_button_icon">
                                <img src="/ims_treatment/static/description/icon_template_archive.png" alt="Store"/>
                            </div>
                            <label for="template_count" attrs="{'invisible': [('template_count','!=',0)]}" string="Mẫu trữ"/>
                            <field name="template_count" widget="statinfo" attrs="{'invisible': [('template_count','=',0)]}"/>
                        </button>
                        <button name="button_list_treatment" type="object" class="oe_stat_button" icon="fa-magic" style="width: 12.5%;">
                            <label for="treatment_count" attrs="{'invisible': [('treatment_count','!=',0)]}"/>
                            <field name="treatment_count" widget="statinfo" attrs="{'invisible': [('treatment_count','=',0)]}"/>
                        </button>
                        <button name="button_list_result_treatment" type="object" class="oe_stat_button" style="width: 12.5%;">
                            <div class="fa fa-fw o_button_icon">
                                <img src="/ims_treatment/static/description/icon_result.png" alt="Result"/>
                            </div>
                            <label for="result_treatment_count" attrs="{'invisible': [('result_treatment_count','!=',0)]}"/>
                            <field name="result_treatment_count" widget="statinfo" attrs="{'invisible': [('result_treatment_count','=',0)]}"/>
                        </button>
                        <button name="button_list_assigned" type="object" class="oe_stat_button" style="width: 12.5%;">
                            <div class="fa fa-fw o_button_icon">
                                <img src="/ims_treatment/static/description/icon_assign.png" alt="Assign"/>
                            </div>
                            <label for="assigned_count" attrs="{'invisible': [('assigned_count','!=',0)]}"/>
                            <field name="assigned_count" widget="statinfo" attrs="{'invisible': [('assigned_count','=',0)]}"/>
                        </button>
                    </div>
                    <widget name="web_ribbon" title="Archived" bg_color="bg-danger" attrs="{'invisible': [('active', '=', True)]}"/>
                    <field name="is_locked" invisible="1"/>
                    <field name="last_stage" invisible="1"/>
                    <label for="name" class="oe_edit_only" string="Họ Tên"/>
                            <h1 style="font-weight:bold; color:#000000">
                                <field name="patient_id" required="1" options="{'no_open': True, 'no_create': True, 'no_create_edit': True}"/>
                                
                            </h1>
                    <group col="3" colspan="6">
                        <group string="Thông tin chung" style="font-weight: bold" col="2">
                            <field name="name" readonly="1"/>
                            <field name="patient_code" readonly="1"/>
                            <field name="internal_ref" readonly="1"/>
                            <field name='stage_id' invisible="1"/>
                            <field name="birthday" />
                            <!-- <label for="birthday"/>
                            <div>
                                <field name="day_birth" class="oe_inline"/> - <field name="month_birth" class="oe_inline"/> - <field name="year_birth" class="oe_inline"/>
                            </div> -->
                            <field name="gender" required="1"/>
                            <field name="role" required="0" invisible="1"/>
                            <field name="loop_contact_id" readonly="1" options="{'no_open': True, 'no_create': True}" force_save="1"/>
                            <field name="mobile"/>
                            <field name="department_id" invisible="1"/>
                            <field name="time_year"/>
                            <field name="time_month"/>
                        </group>
                        <group string="Thông tin điều trị" style="font-weight: bold" col="2">
                            <field name="technical" invisible="1"/>
                            <field name="technique_id" required="1" readonly="1" force_save="1" options="{'no_open': True, 'no_create': True}"/>
                            <field name="doctor_id" required="1" context="{'default_is_doctor': 1}" options="{'no_open': True, 'no_create': True}"/>
                            <field name="times_use" readonly='0'/>
                            
                            <field name="medical_protocol_id" options="{'no_open': True, 'no_create': True}" domain="[('technique_ids', 'in', [technique_id])]"/>
                            <field name="medical_protocol_id_note" attrs="{'invisible':[('show_note_protocol', '=', False)]}"/>
                            <field name="para" attrs="{'invisible': [('gender','!=','female')]}"/>
                            <field name="date_end_menses" required="0" attrs="{'invisible': [('gender','!=','female')]}"/>
                            <field name="cause_ids" widget="many2many_tags" options="{'color_field': 'color', 'no_open': True, 'no_create': True}"/>
                            <field name="cause_ids_note" attrs="{'invisible':[('show_note_cause', '=', False)]}"/>
                            <field name="technical_sub_id" invisible="1"/>
                            <field name="manual_readonly_tab_doctor" invisible="1"/>
                            <field name="show_note_cause" invisible="1"/>
                            <field name="show_note_protocol" invisible="1"/>
                        </group>
                        <group string="Kế hoạch điều trị" style="font-weight: bold" col="2">
                            <field name="is_ovum" attrs="{'invisible': ['|',('technical','not in',('ICSI/IVF')),('gender','=','male')]}"/>
                            <field name="egg_donor_id" options="{'no_open': True, 'no_create': True}" invisible="1"/>
                            <field name="is_mangthai_ho" attrs="{'invisible': ['|',('technical','in',('surgery_testis', 'IUI/QHTN')),('gender','=','male')]}"/>
                            <field name="mangthai_ho" options="{'no_open': True, 'no_create': True}" attrs="{'invisible': [('is_mangthai_ho','!=',True)]}"/>
                            <field name="ra_trung" attrs="{'invisible': ['|',('technical','not in',('ICSI/IVF')),('gender','=','male')]}"/>
                            <field name="is_tru" attrs="{'invisible': ['|',('technical','in',('IUI/QHTN','FET','ICSI/IVF','surgery_testis')),('gender','=','male')] }"/>
                            <field name="is_tt_tru" attrs="{'invisible': ['|',('technical','!=','ICSI/IVF'),('gender','=','male')]}"/>
                            <field name="is_pesa" attrs="{'invisible': ['|',('gender','=','male'),('technical','in',('IUI/QHTN','FET','surgery_testis'))]}"/>
                            <field name="is_tese" attrs="{'invisible': ['|',('gender','=','male'),('technical','in',('IUI/QHTN','FET','surgery_testis'))]}"/>
                            <!-- <field name="is_xin_trung" attrs="{'invisible': [('technical','in',('IUI/QHTN','FET','ICSI/IVF','surgery_testis'))]}"/> -->
                            <field name="is_xin_tt" attrs="{'invisible': ['|',('gender','=','male'),('technical','in',('IUI/QHTN','FET','surgery_testis'))]}"/>
                            <!-- <field name="is_aoa" attrs="{'invisible': ['|',('gender','=','male'),('technical','in',('IUI/QHTN','FET','surgery_testis'))]}"/> -->
                            <field name="ra_embryo" attrs="{'invisible': [('technical','!=','FET')]}"/>
                            <!-- <field name="ra_zygote" attrs="{'invisible': [('technical','in',('IUI/QHTN','FET','ICSI/IVF','surgery_testis')),('gender','=','male')]}"/> -->
                            <field name="center_id" required="0" invisible="1"/>
                            <field name="date_of_appointment" attrs="{'invisible': [('technical','not in',('surgery_testis'))]}"/>
                            <field name="technical_is_date_of_appointment" invisible="1"/>
                            <label for="note_doctor" style="font-weight: bold; color:#ff0000"/>
                                    <div>
                                        <field name="note_doctor" nolabel="1" style="color:#ff0000"/>
                                    </div>
                            <label for="notes" string="Lưu ý Kế hoạch điều trị" style="font-weight: bold; color:#0066ff"/>
                                    <div>
                                        <field name="notes" nolabel="1" style="color:#0066ff"/>
                                    </div>
                            
                        </group>
                    </group>
                    <group name="g_invisible" invisible="1">
                            <field name="is_xin_tt_nam" invisible="1"/>
                    </group>
                    <group class="kanban_group_contact">
                        <field name="contact_ids" nolabel="1" mode="kanban"
                            context="{'patient_id': active_id}"
                            readonly="1" force_save="1"
                            attrs="{'invisible': [('loop_contact_id','=',False)]}" class="kanban_custom_contact"/>
                    </group>
                    <notebook>
                        <page name="fet1" string="Xét nghiệm" groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_midwife,ims_treatment.group_doctor">
                            <field name="test_ids" nolabel="1" context="{'default_patient_id': patient_id, 'default_role': role}">
                                <tree string="Xét nghiệm">
                                    <field name="type"/>
                                    <field name="group"/>
                                    <field name="role"/>
                                    <field name="doctor_id"/>
                                    <field name="date"/>
                                    <field name="doctor_perform_id"/>
                                    <field name="date_perform" string="Giờ thực hiện"/>
                                    <field name="date_done"/>
                                    <field name="index_result"/>
                                    <field name="state" string="Kết quả"/>
                                    <field name="note"/>
                                </tree>
                            </field>
                        </page>
                        <page name="fet2" string="Theo dõi NMTC" groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_midwife,ims_treatment.group_doctor">
                            <!-- <group col="4">
                                <field name="order_menses"/>
                                <field name="date_follow"/>
                            </group>
                            <button name="act_load_prescription" string="Cập nhật theo dõi" type="object" class="oe_highlight"/> -->
                            <field name="follicular_ids" nolabel="1" context="{'default_patient_id': patient_id}">
                                <tree default_order="date">
                                    <field name="period" string="Menstrual Period"/>
                                    <field name="order_week" optional="hide"/>
                                    <field name="date"/>
                                    <field name="decision_id" class="o_list_text"/>
                                    <field name="nang_trai"/>
                                    <field name="total_qty_left"/>
                                    <field name="nang_phai"/>
                                    <field name="total_qty_right"/>
                                    <field name="endometrium"/>
                                    <field name="calendar_sa" optional="show" class="o_list_text"/>
                                    <field name="calendar_tt" string="Lịch hẹn chuyển phôi trữ" optional="show" class="o_list_text"/>
                                    <field name="note" optional="show"/>
                                    <field name="name" invisible="1"/>
                                </tree>
                                <form>
                                    <group>
                                        <group string="Thông tin theo dõi">
                                            <field name="patient_id" invisible="1"/>
                                            <field name="name" readonly="1"/>
                                            <field name="period" required="1" string="Menstrual Period"/>
                                            <field name="date" required="1"/>
                                            <field name="order_week" readonly="1"/>
                                            <field name="hgm" invisible="1"/>
                                            <field name="nang_trai"/>
                                            <field name="nang_phai"/>
                                            <field name="endometrium"/>
                                            <field name="note_endometrium" />
                                        </group>
                                        <group string="Kết quả liên quan">
                                            <field name="decision_id" required="1"/>
                                            <field name="image" invisible="1" widget="image" class="oe_avatar" options="{'preview_image': 'image_128'}" style="float: left !important;"/>
                                            <field name="note"/>
                                            
                                            <field name="calendar_sa"/>
                                            <field name="calendar_tt" string="Lịch hẹn chuyển phôi trữ"
                                                attrs="{'required': [('decision_id', '=', 'transfer')]}"/>
                                            <field name="prescribe"/>
                                            <field name="type_prescribe" readonly="1" attrs="{'invisible': [('prescribe','!=', 'other')]}"/>
                                            <!-- <field name="date_fet_continue" attrs="{'invisible': ['|',('decision_id', '!=', 'transfer'),('prescribe', 'not in', ['d2_d5', 'd3_d5'])]}"/> -->
                                            <field name="technical" invisible="1"/>
                                            <field name="patient_id" invisible="1"/>
                                            <field name="technical_is_calendar_sa" invisible="1"/>
                                            <field name="technical_is_datetime_hcg" invisible="1"/>
                                            <field name="technical_is_date_thawing_ovum" invisible="1"/>
                                            <field name="technical_is_calendar_tt" invisible="1"/>
                                            
                                        </group>
                                    </group>
                                    <notebook>
                                        <page name="ovums_detail" string="Chi tiết 2 bên nang BT">
                                            <group>
                                                <group>
                                                    <field name="right_ovary"/>
                                                    <field name="note_right_ovary" />
                                                </group>
                                                <group>
                                                    <field name="left_ovary"/>
                                                    <field name="note_left_ovary" />
                                                </group>
                                            </group>
                                            <field name="size_ids" nolabel="1">
                                                <tree editable="bottom">
                                                    <field name="size" required="1" width="8.0"/>
                                                    <field name="qty_right" width="5.0"/>
                                                    <field name="qty_left" width="5.0"/>
                                                </tree>
                                                <form>
                                                    <group col="4">
                                                        <field name="size" required="1"/>
                                                        <field name="qty_right"/>
                                                        <field name="qty_left"/>
                                                    </group>
                                                </form>
                                            </field>
                                        </page>
                                        <page string="Chỉ số nội tiết" invisible="1">
                                            <field name="index_hormonal_ids" nolabel="1">
                                                <tree editable="bottom">
                                                    <field name="name" required="1"/>
                                                    <field name="value"/>
                                                </tree>
                                            </field>
                                        </page>
                                    </notebook>
                                </form>
                            </field>
                        </page>
                        <page name="fet10" string="Chi tiết mẫu trữ" groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_doctor" attrs="{'invisible': [('gender', '=', 'female')]}">
                            <!-- <separator string="Mẫu mang đi trữ" attrs="{'invisible': [('gender','!=','female')]}"/> -->
                            <!-- <button name="%(action_medical_take_away_archive)d" string="Tạo phiếu chờ trữ" type="action" context="{'archive': True}" class="oe_highlight" attrs="{'invisible': ['|',('culture_archive_ids','=',[]),('gender','!=','female')]}"/> -->
                            <!-- <field name="culture_archive_ids" nolabel="1" readonly="1" attrs="{'invisible': [('gender','!=','female')]}" context="{'is_invisible_button_next': 1}"/> -->
                            <separator string="Phiếu chờ trữ"/>
                            <button name="%(action_create_waiting_archive_male_popup)d" string="Tạo phiếu chờ trữ" type="action" class="oe_highlight" attrs="{'invisible': [('gender','!=','male')]}"/>
                            <field name="waiting_archive_ids" nolabel="1" readonly="1"/>
                            <separator string="Chi tiết trữ Nam" attrs="{'invisible': [('gender','!=','male')]}"/>
                            <separator string="Chi tiết trữ Nữ" attrs="{'invisible': [('gender','!=','female')]}"/>
                            <field name="archive_semen_ids" nolabel="1" context="{'default_type': 'semen', 'default_state': 'archive', 'default_patient_id': patient_id, 'is_follow_male': True}" 
                                domain="[('patient_id','=', patient_id),('type_template','in',('semen','sperm_pt','sperm'))]" attrs="{'invisible': [('gender','!=','male')]}" readonly="1"/>
                            <field name="archive_zygote_ids" nolabel="1" context="{'default_type': 'zygote', 'default_state': 'archive', 'default_patient_id': patient_id, 'is_follow_female': True}" 
                                domain="[('patient_id','=', patient_id),('type_template','in',('ovum','zygote','embryos'))]" attrs="{'invisible': [('gender','!=','female')]}" readonly="1"/>
                        </page>
                        <page name="fet11" string="Chi tiết mẫu rã" groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_doctor">
                            <separator string="Chi tiết rã Nam" attrs="{'invisible': [('gender','!=','male')]}"/>
                            <separator string="Chi tiết rã Nữ" attrs="{'invisible': [('gender','!=','female')]}"/>
                            <!-- <button name="%(action_medical_decay_template_popup)d" string="Rã đợt này" type="action" class="oe_highlight" attrs="{'invisible': [('technical','=','FET')]}"/> -->
                            <button name="%(action_medical_decay_template_all_popup)d" string="Mẫu mang đi rã" type="action" class="oe_highlight"
                                attrs="{'invisible': [('is_xin_tt_nam', '=', True)]}"/>
                            <button style="margin-left: 5px;" string="Rã ngân hàng" type="action" name="%(action_medical_decay_template_bank_popup)d" class="oe_highlight btn" attrs="{'invisible': [('is_xin_tt_nam', '=', False)]}"/>
                            <field name="decay_semen_ids" nolabel="1" context="{'default_type': 'semen', 'default_state': 'decay', 'default_patient_id': patient_id, 'is_follow_male': True}" 
                                domain="[('type','=','semen'),('state','in',['decay', 'wait_decay'])]" attrs="{'invisible': [('gender','!=','male')]}">
                                <tree>
                                    <field name="canes_id"/>
                                    <field name="code" attrs="{'column_invisible': [('parent.is_xin_tt_nam', '=', True)]}"/>
                                    <field name="code_bank" attrs="{'column_invisible': [('parent.is_xin_tt_nam', '=', False)]}"/>
                                    <field name="tool_archive_id"/>
                                    <field name="location"/>
                                    <field name="archive_qty"/>
                                    <field name="date"/>
                                    <field name="date_deadline"/>
                                </tree>
                            </field>
                            <field name="decay_zygote_ids" nolabel="1" context="{'default_type': 'zygote', 'default_state': 'decay', 'default_patient_id': patient_id, 'is_follow_female': True}" 
                                domain="[('type','=','zygote'),('state','in',['decay', 'wait_decay'])]" attrs="{'invisible': [('gender','!=','female')]}">
                                <tree>
                                    <field name="canes_id"/>
                                    <field name="code" attrs="{'column_invisible': [('parent.is_xin_tt_nam', '=', True)]}"/>
                                    <field name="code_bank" attrs="{'column_invisible': [('parent.is_xin_tt_nam', '=', False)]}"/>
                                    <field name="tool_archive_id"/>
                                    <field name="location"/>
                                    <field name="archive_qty"/>
                                    <field name="date"/>
                                    <field name="date_deadline"/>
                                </tree>
                            </field>
                            <separator string="Phiếu chờ rã"/>
                            <field name="waiting_decay_ids" nolabel="1" readonly="1"/>
                            <separator string="Mã mẫu rã" attrs="{'invisible': [('gender','!=','female')]}"/>
                            <field name="culture_decay_ids" nolabel="1" domain="[('is_history','=',False)]" attrs="{'invisible': [('gender','!=','female')]}" context="{'is_invisible_button_next': 1}">
                                <tree>
                                    <field name="name"/>
                                    <field name="type"/>
                                    <field name="info_type"/>
                                    <field name="decision_id"/>
                                </tree>
                            </field>
                        </page>
                        <page name="fet12" string="Thông tin phôi chuyển" groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_doctor">
                            <button string="Update Transfer Embryo" name="action_update_embryo_transfer" type="object" class="oe_highlight"
                                confirm="Are you sure to do this action? This action will be updating the last result!"/>
                            <group>
                                <group string="Thông tin phôi trữ">
                                    <field name="qty_cold_embryos_stockpiled" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="cold_embryos_stockpiled_level_1" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="cold_embryos_stockpiled_level_2" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="cold_embryos_stockpiled_level_3" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="qty_cold_embryos_thawed" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="cold_embryos_thawed_level_1" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="cold_embryos_thawed_level_2" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="cold_embryos_thawed_level_3" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                                <group string="Thông tin phôi chuyển">
                                    <field name="qty_embryos_transfer" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <div>
                                        <field name="embryos_transfer_day_2" string="Ngày 2" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                        <label for="embryos_transfer_day_2"/>
                                    </div>
                                    <div>
                                        <field name="embryos_transfer_day_3" string="Ngày 3" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                        <label for="embryos_transfer_day_3"/>
                                    </div>
                                    <div>
                                        <field name="embryos_transfer_day_4"/>
                                        <label for="embryos_transfer_day_4"/>
                                    </div>
                                    <div>
                                        <field name="embryos_transfer_day_5" string="Ngày 5" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                        <label for="embryos_transfer_day_5"/>
                                    </div>
                                    <div>
                                        <field name="embryos_transfer_day_6" string="Ngày 6" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                        <label for="embryos_transfer_day_6"/>
                                    </div>
                                    <field name="embryos_transfer_level_1" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="embryos_transfer_level_2" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="embryos_transfer_level_3" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="qty_embryos_cancel" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="qty_cold_embryos_stockpiled_in_stock" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                            </group>
                        </page>
                        <page name="fet13" string="Chuyển phôi" groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_doctor">
                            <group>
                                <group string="Thời gian &amp; Nhân sự tham gia chuyển phôi">
                                    <field name="date_transfer" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="doctor_transfer_id" options="{'no_open': True, 'no_create': True}" context="{'default_is_doctor': 1}" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="empl_transfer_id" options="{'no_open': True, 'no_create': True}" context="{'default_is_employee': 1}" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="empl_lab_load_id" options="{'no_open': True, 'no_create': True}" context="{'default_is_employee': 1}" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="empl_lab_check_id" options="{'no_open': True, 'no_create': True}" context="{'default_is_employee': 1}" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="note_empl" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                                <group string="Tình trạng chuyển phôi">
                                    <field name="transfer_embryo" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="is_easy" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="is_difficult" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="is_transfer_2" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="is_pozzi" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="is_sot_phoi" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="image_embryo_transfer" widget="image" class="oe_avatar"
                                        options="{'zoom': true,'field_zoom': 'image_embryo_transfer'}"
                                        style="float: left !important;" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                            </group>
                            <group>
                                <group string="Ghi chú khác">
                                    <field name="catheter_id" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="type_catheter" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="note_type" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                                <group string="Độ sạch của Catheter sau chuyển phôi">
                                    <field name="is_clean" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="is_viscous" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="viscous" attrs="{'invisible': [('is_viscous','!=',True)],'readonly': [('manual_readonly_tab_doctor','=',False)]}"/> 
                                    <field name="is_blood" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="blood" attrs="{'invisible': [('is_blood','!=',True)], 'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                            </group>
                            <group>
                                <group>
                                    <field name="is_tool_support" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="note_tool_support" attrs="{'invisible': [('is_tool_support','!=','yes')],'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="is_anesthesia" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                    <field name="note_anesthesia" attrs="{'invisible': [('is_anesthesia','!=','yes')],'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                                <group>
                                    <field name="status_tranfer" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}"/>
                                </group>
                            </group>
                        </page>
                        <page name="fet14" string="Bảng kiểm quy trình"  invisible="1"
                                attrs="{'invisible': [('gender', '=', 'female')]}"
                                groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_doctor">
                            <field name="process_ids" nolabel="1" attrs="{'readonly': [('manual_readonly_tab_doctor','=',False)]}">
                                <tree string="Bảng kiểm quy trình">
                                    <field name="date"/>
                                    <field name="stage_id"/>
                                    <field name="performer_id" options="{'no_open': True, 'no_create': True}"/>
                                    <field name="checker_id" options="{'no_open': True, 'no_create': True}"/>
                                    <field name="note"/>
                                </tree>
                            </field>
                        </page>
                        <page name="fet16" string="Gửi yêu cầu" invisible="1" groups="base.group_no_one,ims_treatment.group_manager,ims_treatment.group_doctor">
                            <field name="transfer_ids" nolabel="1" context="{'default_patient_id': patient_id, 'default_role': role}">
                                <tree string="Gửi yêu cầu">
                                    <field name="stt" invisible="1"/>
                                    <field name="name"/>
                                    <field name="role"/>
                                    <field name="request"/>
                                    <field name="notes"/>
                                    <field name="transfer_to"/>
                                    <field name="is_emergency"/>
                                    <field name="state"/>
                                </tree>
                            </field>
                        </page>
                        <page name="9" invisible="1">
                            <button name="%(action_medical_take_away_archive)d" string="Mẫu mang đi trữ" type="action" class="oe_highlight" attrs="{'invisible': [('culture_ids','=',[])]}"/>
                            <field name="culture_ids" nolabel="1" context="{'default_patient_id': patient_id, 'default_is_save': True, 'default_date_chochut': date_choc_hut, 'is_follow_treatment': 1}">
                                <tree>
                                    <field name="stt" invisible="1"/>
                                </tree>
                            </field>
                        </page>
                        <page name="5" string="Chọc hút" invisible="1">
                            <group>
                                <group string="Thời gian &amp; Nhân sự tham gia chọc hút">
                                    <field name="date_choc_hut"/>
                                    <field name="doctor_choc_hut" options="{'no_open': True, 'no_create': True}" context="{'default_is_doctor': 1}"/>
                                    <field name="empl_choc_hut" options="{'no_open': True, 'no_create': True}"/>
                                    <field name="anesthesiologist_id" options="{'no_open': True, 'no_create': True}"/>
                                    <field name="qty_expected"/>
                                    <field name="qty_choc_hut"/>
                                    <field name="qty_ovum"/>
                                </group>
                                <group string="Tình trạng bệnh nhân khi chọc hút">
                                    <field name="status_chochut" invisible="1"/>
                                    <field name="blood_pressure" invisible="1"/>
                                    <field name="heartbeat" invisible="1"/>
                                    <field name="note_other" string="Ghi chú khác"/>
                                    <field name="description"/>
                                </group>
                            </group>
                            <group>
                                <group string="Ghi chú khác">
                                    <field name="needle_id"/>
                                    <field name="code_needle"/>
                                    <field name="note_chochut"/>
                                    <field name="form_chochut"/>
                                </group>
                                <group string="Tình trạng bệnh nhân sau chọc hút">
                                    <field name="status_after"/>
                                    <field name="note_after"/>
                                    <field name="solution"/>
                                </group>
                            </group>
                        </page>
                        <page name="15" string="Giấy tờ điều trị">
                            <field name="papers_ivf_ids" nolabel="1">
                                <tree editable="bottom">
                                    <field name="name_ivf" />
                                    <field name="detail_ivf_file" widget="binary" filename="file_ivf_name"/>
                                    <field name="file_ivf_name" invisible="1"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Theo dõi điều trị FET -->
    <record id="action_treatment_fet" model="ir.actions.act_window">
        <field name="name">Theo dõi điều trị FET</field>
        <field name="res_model">medical.treatment</field>
        <field name="view_mode">tree,form</field>
        <field name="context">{'default_technical': 'FET', 'is_fet': 1, 'is_not_lab': 1,'is_menu_doctor':1}</field>
        <field name="domain">[('technical','=','FET')]</field>
        <field name="search_view_id" ref="view_medical_treatment_icsi_ivf_search"/>
    </record>

    <record id="action_treatment_fet_tree" model="ir.actions.act_window.view">
        <field eval="0" name="sequence"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_medical_treatment_icsi_ivf_tree"/>
        <field name="act_window_id" ref="action_treatment_fet"/>
    </record>

    <record id="action_treatment_fet_form" model="ir.actions.act_window.view">
        <field eval="1" name="sequence"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="view_medical_treatment_icsi_fet_form"/>
        <field name="act_window_id" ref="action_treatment_fet"/>
    </record>
</odoo>
